# C# + MaxScript
С помощью C# формируем MaxScript и визуализируем данные в 3DS Max
<h2>Содержание</h2>
<ul>
  <li><a href="#task">Задача;</a></li>
  <li><a href="#theory">Немного теории об алгоритме компоновки;</a></li>
  <li><a href="#sharp">Код С#;</a></li>
  <li><a href="#max">Код MaxScript;</a></li>
  <li><a href="#result">Результат работы.</a></li>
</ul>

<h2 id="task">Задача</h2>
<p align="justify">
Поставлена задача применить алгоритм компоновки печатной платы. Сам алгоритм применить не сложно, он последовательный, что упрощает процесс кодирования.
</p>

<p align="justify">
Но возникает вопрос: "А как визуализировать результат компоновки?".
</p>

<h2 id="theory">Немного теории об алгоритме компоновки</h2>

<p align="justify">
Принципиальные электрические схемы соединения многоконтактных элементов (например, микросхем и микросборок) удобно представлять гиперграфом Q и записывать в виде матрицы цепей:
</p>

<p>
<a href="https://fotki.yandex.ru/next/users/akasikov/album/550520/view/2341652?page=0" target="_blank"><img src="https://img-fotki.yandex.ru/get/477464/49342033.0/0_23bb14_3fa750ed_orig.png" width="172" height="46" border="0" title="1.PNG" alt="1.PNG"/></a>
</p>

<p align="justify">
где m — число элементов схемы; k — число выводов многоконтакт-ных элементов.
</p>

<p align="justify">
Элемент Сij матрицы С означает номер электрической цепи, которая подключается к j-му выводу i-го многоконтактного элемента. Если контакт свободен, то Сij = 0. Оптимальному разбиению схемы на n частей G1, G2. …, Gn соответствует такое разбиение матрицы С на подматрицы С1. С2. .... Сn, при котором число связей между частями минимально. Критерий оптимальности в этом случае записывается в виде:
</p>

<p>
<img src="https://img-fotki.yandex.ru/get/772910/49342033.0/0_23bb15_901896b1_orig.png" width="489" height="78" border="0" title="2.PNG" alt="2.PNG"/>
</p>

<p>
где Rij — число связей между i-й и j-й частями.
</p>

<p align="justify">
Работа алгоритма заключается в поочередном определении для каждого элемента Ui схемы чисел ∆R<sub>1</sub><sup>i</sup>, ∆R<sub>2</sub><sup>i</sup>…∆R<sub>n</sub><sup>i</sup>, характе¬ризующих приращение связей при расположении этого элемента в части G1, G2…Gn. Для определения этих чисел вводится вспо¬могательная матрица W = || wij ||<sup>n x l</sub>
</p>
<p>
где l — число цепей схемы; n — число частей разбиения.
</p>

<p>
Элемент матрицы Wij определяется соотношением:
</p>

<p>
<img src="https://img-fotki.yandex.ru/get/962386/49342033.0/0_23bb16_f0688493_orig.png" width="541" height="67" border="0" title="3.PNG" alt="3.PNG"/>
</p>
